// Images
$('.alt').click(function() {
	var href = $(this).attr('data-href');
	var src = $(this).attr('data-src');
	$('.href').attr('href',href);
	$('.src').attr('src',src);
});
lightbox.option({'wrapAround':true,'showImageNumberLabel':false});

// Product form simple
{% if product.variants.size > 1 %}
	$('.product-select').change(function() {
		{% for variant in product.variants %}
			if(id == {{ variant.id }}) {
				var price = "{{ variant.price | money }}";
				var avail = {{ variant.available }};
				{% if variant.featured_image %}
					$('.src').attr('src','{{ variant.featured_image | img_url:'grande' }}');
					$('.href').attr('href','{{ variant.featured_image | img_url:'grande' }}');
				{% endif %}
			}
		{% endfor %}
		if(avail == true) {
			$('.price').text(price);
		} else {
			$('.price').text('Unavailable');
		}
	});
{% endif %}

// Cross Sell
function fisherYates ( myArray ) {
	var i = myArray.length,j,temp;
	if (i === 0) return false;
	while (--i) {
		j = Math.floor(Math.random()*(i+1));
		temp = myArray[i];
		myArray[i] = myArray[j]; 
		myArray[j] = temp;
	}
}
var products = new Array();
{% assign current = product.url %}
{% assign count = 0 %}
{% assign display-count = 4 %}
{% if collection and collection.all_products_count > 1 %}
	{% for product in collection.products %}{% unless product.url == current %}products[{{ count }}] = "<a href='{{ product.url | within:collection }}'><img src='{{ product.images[0] | img_url:'large' }}' alt='{{ product.title | escape }}' /></a>";{% assign count = count | plus:1 %}{% endunless %}{% endfor %}
{% else %}
	{% for product in collections.all.products %}{% unless product.url == current %}products[{{ count }}] = "<a href='{{ product.url }}'><img src='{{ product.images[0] | img_url:'large' }}' alt='{{ shop.name | escape }}' /></a>";{% assign count = count | plus:1 %}{% endunless %}{% endfor %}
{% endif %}	
{% if count > display-count %}{% assign count = display-count %}{% endif %}
fisherYates(products);
var crossContent = products[0];
for(var i=1; i<{{ count }}; i++) {
	products += products[i];
}
$('.cross-sell').html(crossContent);	
	
{% comment %}
// Product form extended
$('.options').change(function() {
	{% if product.options[0] %}var opt1 = $('.option1').val();{% endif %}
	{% if product.options[1] %}var opt2 = $('.option2').val();{% endif %}
	{% if product.options[2] %}var opt3 = $('.option3').val();{% endif %}
	var id = '';
	{% for variant in product.variants %}
		if(opt1=="{{ variant.option1 }}"{% if product.options[1] %} && opt2=="{{ variant.option2 }}"{% endif %}{% if product.options[2] %} && opt3=="{{ variant.option3 }}"{% endif %}) {
			var id = "{{ variant.id }}";
			var price = "{{ variant.price | money }}";
			{% if variant.featured_image %}
				$('.src').attr('src','{{ variant.featured_image | img_url:'grande' }}');
				$('.href').attr('href','{{ variant.featured_image | img_url:'1024x1024' }}');
			{% endif %}
		}
	{% endfor %}
	if(id!='') {
		$('.product-select').val(id);
		$('.price').text(price);
	} else {
		$('.product-select').val('');
		$('.price').text('Unavailable');
	}
});
{% endcomment %}